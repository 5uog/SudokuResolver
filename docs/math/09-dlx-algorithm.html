<!-- docs/math/9-dlx-algorithm.html -->
<section class="chapter" id="9-dlx-algorithm">
    <h2 id="9-dlx-algorithm">9. 生成アルゴリズム（DLX）</h2>
    <div class="para">
        数独問題の生成において決定的に重要となるのは、一意解性を確実に保証するための厳密な検証手続きである。完全盤から与え値を順次削除していく操作は表面的には単純であるが、その各段階で「解がただ一つしか存在しない」という条件を満たすか否かを判定する必要がある。この判定を効率的かつ形式的に遂行するためには、Donald Knuth によって提案された Dancing Links (DLX) アルゴリズムを exact cover 問題の枠組みに適用することが最も有効である。形式化の過程としては、数独の全制約を $729 \times 324$ の二値疎行列に符号化する手順を踏む。すなわち、729 行は「セル $(r,c)$ に数字 $d$ を置く」という可能な割当を表し、324 列は四種類の制約すなわち「各セルには正確に一つの数字が入る」「各行には $1$ から $9$ が一度ずつ現れる」「各列には $1$ から $9$ が一度ずつ現れる」「各 $3\times 3$ ボックスには $1$ から $9$ が一度ずつ現れる」を反映する。あるセルに与え値が事前に指定されている場合、その候補以外の行はすべて削除され、残余の部分行列が生成される。したがって、問題の充足可能性はこの exact cover 行列の解として対応づけられる。DLX は dancing links と呼ばれる双方向連結構造を利用して列削除と復元を高速に行い、exact cover の全解を網羅的に探索するアルゴリズムである。数独における一意性判定では、DLX を「二解検出器」として用いることが肝要である。すなわち、一つの解が発見された時点で探索を停止せず、探索を継続して二つ目の解が出現した瞬間に即座に停止し「多解あり」と判定する。逆に探索を最後まで行っても二解目が見つからなければ、その問題は一意解性を有することが保証される。この仕組みによって、一意性検証は不要な探索を極限まで抑制しつつ厳密性を保持する。問題生成アルゴリズムはこの一意性判定を逐次的に適用しつつ進行する。すなわち、与え値集合から一つのセルを候補に選び、それを削除した盤面を構築する。その後 DLX によって一意性検査を実行し、依然として解が一つである場合のみ削除を確定する。もし二解目が検出されれば、その削除は棄却され、別のセルが選択される。この操作を繰り返すことで、完全盤から制約を緩めつつも常に一意解性が保持された状態が維持され、最終的に安定的に一意解数独問題を構築することが可能となる。以上の枠組みは、問題生成における「解の存在」と「解の一意性」とを明確に区別しつつ、両者を exact cover 問題の数理的形式化によって統一的に扱うものである。DLX による一意性検証は、単に効率的であるにとどまらず、生成過程全体の論理的厳密性を支える基盤技術として位置づけられる。
    </div>
</section>